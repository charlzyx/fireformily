"use strict";(self.webpackChunkfireformily=self.webpackChunkfireformily||[]).push([[896,633],{27890:function(ee,N,s){s.r(N),s.d(N,{default:function(){return q}});var T=s(5574),E=s.n(T),L=s(87462),x=s(67294),R={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"robot",theme:"outlined"},F=R,D=s(98615),M=function(e,o){return x.createElement(D.Z,(0,L.Z)({},e,{ref:o,icon:F}))},b=x.forwardRef(M),y=s(9168),P=s(99619),S=s(27420),A=s(71577),m=s(55413),z=s(19632),H=s.n(z),J=s(52677),j=s.n(J),d=function(e){var o=new WeakMap,t=function r(n){if(Array.isArray(n))return n.map(r);if(typeof n=="function")return"f ".concat(n.displayName||n.name,"(){ }");if(j()(n)==="object"){if(o.get(n))return"#CircularReference";if(!n)return n;if("$$typeof"in n&&"_owner"in n)return o.set(n,!0),"#ReactNode";if(n.toJS)return o.set(n,!0),n.toJS();if(n.toJSON)return o.set(n,!0),n.toJSON();o.set(n,!0);var l={};for(var u in n)l[u]=r(n[u]);return o.set(n,!1),l}return n};return JSON.stringify(t(e),null,2)},g=4,C="https://unpkg.com/china-location@2.1.0/dist/location.json",O=function(e){var o=[],t=Object.values(e).map(function(r,n){if(!(n>g))return o.push({code:r.code,name:r.name}),r.children=Object.values(r.cities).map(function(l,u){if(u>g)return null;var c=l.code===r.code?"".concat(l.code,"00"):l.code;return o.push({code:c,name:l.name,parent:r.code}),l.children=Object.entries(l.districts).map(function(i,f){var $=E()(i,2),h=$[0],I=$[1];if(!(f>g)){var _=h===c||h==r.code?"".concat(h,"0000"):h;return o.push({code:_,name:I,parent:c}),{code:h,name:I}}}).filter(Boolean),l}).filter(Boolean),r}).filter(Boolean);return{flatten:o,tree:t}},B=function(e){return fetch(C).then(function(o){return o.json()}).then(function(o){return O(o)}).then(function(o){var t=o.flatten;return t.filter(function(r){return r.parent===e})})},Z=function(){return fetch(C).then(function(e){return e.json()}).then(function(e){return O(e)}).then(function(e){var o=e.tree,t=o==null?void 0:o.map(function(r,n){var l;if(!(n>g))return{label:r.name,value:r.code,isLeaf:!1,children:(l=r.children)===null||l===void 0?void 0:l.map(function(u,c){if(!(c>g))return{label:u.name,value:u.code===r.code?"".concat(u.code,"00"):u.code,isLeaf:!1,children:u.children.map(function(i,f){if(!(c>g))return{label:i.name,value:i.code,isLeaf:!0}}).filter(Boolean)}}).filter(Boolean)}}).filter(Boolean);return t})},V=function(e){var o=[void 0].concat(H()(e.map(function(n){return n.value}))),t=e[e.length-1],r=!!e.find(function(n){return n.label===void 0||n.__init});return r?Promise.all(o.map(B)).then(function(n){var l=n.reduceRight(function(u,c,i){return u?c.map(function(f){var $=f.code===o[i+1];return{value:f.code,label:f.name,isLeaf:!1,children:$?u:void 0}}):c.map(function(f){return{value:f.code,label:f.name,isLeaf:!0}})},null);return l}):B(t==null?void 0:t.value).then(function(n){return n.map(function(l){return{value:l.code,label:l.name,isLeaf:o.length===3}})})},v=function(e,o){console.log("LABEL:",e);try{console.group(d(o))}catch(t){console.log("stringify error, origin: ",o)}console.groupEnd()},K={update:{load:function(e){return v("add load args",e),Promise.resolve(e.$record)},cancel:function(e){v("add cancel args",e)},submit:function(e,o){return v("add submit args",{data:e,scope:o}),Promise.resolve()}}},oe={onCopy:function(e){v("onCopy args",e)},onMove:function(e){v("onMove args",e)},onRemove:function(e){v("onRemove args",e)},onAdd:function(e){v("onAdd args",e)}},p=s(85893),U=(0,P.createForm)(),W=function(e){var o,t=(0,x.useState)(""),r=E()(t,2),n=r[0],l=r[1],u=(0,x.useMemo)(function(){return n.split("-").filter(function(i){return i!=""}).map(Number).filter(function(i){return!Number.isNaN(i)})},[n]),c=(o=m.TreeBase.useNode)===null||o===void 0?void 0:o.call(m.TreeBase,u);return(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{children:"Input Node Pos"}),(0,p.jsx)(y.Input,{placeholder:"\u4F8B\u5982: 2-0-1",value:n,onChange:function(f){return l(f.target.value)}}),(0,p.jsx)(A.Z,{type:c&&u.length>0?"primary":"dashed",onClick:function(){if(!c){console.log("---not found node by pos",u);return}console.groupCollapsed("\u70B9\u51FB\u67E5\u770B node scope"),console.group("---node.$pos"),console.log(d(c.$pos)),console.groupEnd(),console.group("---node.$record"),console.log(d(c.$record)),console.groupEnd(),console.group("---node.$index"),console.log(d(c.$index)),console.groupEnd(),console.group("---node.$records"),console.log(d(c.$records)),console.groupEnd(),console.group("---node.$extra"),console.log(d(c.$extra)),console.groupEnd(),console.group("---node.$root"),console.log(d(c.$root)),console.groupEnd()},children:"LOOK NODE SCOPE"})]})},X=function(){var e=(0,m.useExpressionScope)();return(0,p.jsx)(b,{onClick:function(){console.groupCollapsed("\u70B9\u51FB\u67E5\u770B scope"),console.group("---scope.$pos"),console.log(d(e.$pos)),console.groupEnd(),console.group("---scope.$record"),console.log(d(e.$record)),console.groupEnd(),console.group("---scope.$index"),console.log(d(e.$index)),console.groupEnd(),console.group("---scope.$records"),console.log(d(e.$records)),console.groupEnd(),console.group("---scope.$extra"),console.log(d(e.$extra)),console.groupEnd(),console.group("---scope.$root"),console.log(d(e.$root)),console.groupEnd()}})},k=function(e){return(0,p.jsx)("div",{children:"\u5171\u6709 ".concat(e.count," \u4E2A\u4E0B\u7EA7")})},G=function(e){var o=(0,m.useExpressionScope)();return(0,p.jsxs)("div",{style:{margin:"8px 0"},children:[(0,p.jsx)("hr",{}),"SHOULD BE FOOTER",(0,p.jsxs)(A.Z,{size:"small",onClick:function(){return o.$lookup.children.push({value:o.$pos.join("+"),label:"neo"})},type:"primary",children:["index: ",o.$index," | length: ",o.$records.length," | pos: ",o.$pos.join(","),e.hidden?"true":"false"]})]})},Q=(0,S.createSchemaField)({components:{TreeNodes:m.TreeNodes,Space:y.Space,PopActions:m.PopActions,NodeHeader:k,NodeFooter:G,Debug:W,ScopeLogger:X,Input:y.Input,FormItem:y.FormItem},scope:{loadData:V,loadAll:Z,actions:K}}),Y={type:"object",properties:{layout:{type:"void","x-component":"Space","x-component-props":{style:{display:"flex",justifyContent:"space-between"}},properties:{tree:{type:"object","x-decorator":"FormItem","x-component":"TreeNodes","x-component-props":{loadData:"{{loadData}}",loadAll:"{{loadAll}}",checkable:!0,selectable:!0,draggable:!0,layout:{align:"top"}},items:{type:"object",properties:{pos:{type:"void","x-component":"TreeNodes.Pos"},label:{type:"string","x-visible":"{{$record !== $root}}","x-component":"Input","x-component-props":{size:"small",style:{width:"140px"}}},moveup:{type:"void","x-component":"TreeNodes.Move","x-component-props":{to:"up"}},movedown:{type:"void","x-component":"TreeNodes.Move","x-component-props":{to:"down"}},remove:{type:"void","x-component":"TreeNodes.Remove"},copy:{type:"void","x-component":"TreeNodes.Copy","x-component-props":{clone:function(e){return JSON.parse(JSON.stringify(e,function(o,t){return o==="value"?"clone_".concat(t):t}))}}},add:{title:"{{$record === $root ? '\u6DFB\u52A0\u6839\u8282\u70B9': ''}}",type:"void","x-component":"TreeNodes.Append","x-component-props":{factory:function(e){var o,t,r,n;return{label:"".concat(e.label,"\u4E4B ").concat((o=(t=e.children)===null||t===void 0?void 0:t.length)!==null&&o!==void 0?o:0," \u5B50"),value:"".concat(e.value).concat((r=(n=e.children)===null||n===void 0?void 0:n.length)!==null&&r!==void 0?r:0)}}}},edit:{title:"\u7F16\u8F91","x-visible":"{{$record !== $root}}",type:"object","x-component":"PopActions","x-component-props":{actions:"{{actions.update}}"},properties:{label:{type:"string","x-decorator":"FormItem","x-component":"Input"},value:{type:"string","x-decorator":"FormItem","x-component":"Input"}}},scopelog:{type:"void","x-component":"ScopeLogger"}}},properties:{code:{type:"object","x-component":"Debug"}}}}}}},w=function(){return(0,p.jsx)(S.FormProvider,{form:U,children:(0,p.jsx)(Q,{schema:Y})})},q=w}}]);
